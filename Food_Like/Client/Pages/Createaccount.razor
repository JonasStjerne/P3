@page "/createaccount"
@using Food_Like.Shared
@inject HttpClient Http
@inject NavigationManager NavManager

<style>


    .createbtn {
        width: 190px;
        height: 56px;
    }

    .centerdiv {
        display: flex;
        justify-content: center;
        margin: 5px;
    }

    .createpicture {
        height: 118px;
        width: 118px;
        margin-left: auto;
        margin-right: auto;
    }
</style>

<div class="createpicture">
    <a href="createaccount"><img src="/assets/createpicture.png" alt=""></a>
</div>


<div class="centerdiv">
    <form class="form-create ">
        <label for="inputEmail" class="">Email address</label>
        <input type="email" id="inputEmail" class="form-control mb-2 shadow-sm" placeholder="Email address" required autofocus>

        <label for="inputPassword" class="">Password</label>
        <input type="password" id="inputPassword" class="form-control mb-2 shadow-sm" placeholder="Password" required>


        <label for="inputFirstname" class="">Firstname</label>
        <input type="text" id="inputFirstname" class="form-control mb-2 shadow-sm" placeholder="Firstname" required autofocus>

        <label for="inputSurnamee" class="">Surname</label>
        <input type="text" id="inputSurname" class="form-control mb-2 shadow-sm" placeholder="Surname" required autofocus>

        <label for="inputNumber" class="">Mobile</label>
        <input type="number" id="inputNumber" class="form-control mb-2 shadow-sm" placeholder="Mobile" required autofocus>

        <button class="mt-4 btn btn-lg btn-primary btn-block createbtn" type="button">Create</button>

    </form>
    @if (errorMessage.Length > 0)
    {
        <div class="alert alert-danger" role="alert">
            <p>@errorMessage</p>
        </div>
    }
</div>

@code {
    private string errorMessage = "";

    private string email { get; set; }
    private string password { get; set; }
    private string firstname { get; set; }
    private string surname { get; set; }
    private string mobile { get; set; }
    private Byte[] profilePicture;

    private async void submitCreate()
    {
        errorMessage = "";
        var req = new Buyer
        {
            Email = email,
            EncryptedPassword = password,
            FirstName = firstname,
            LastName = surname,
            PhoneNumber = mobile,
            ProfilePicture = profilePicture
        };

        using var response = await Http.PostAsJsonAsync("api/auth/create", req);
        var result = await response.Content.ReadFromJsonAsync<LoginResponse>();
        if (result.Sucess == true)
        {
            NavManager.NavigateTo("/homepage");
        }
        else
        {
            errorMessage = "Wrong password or email";
        }

    }
}




@* Bootstrap 12/11 21 https://getbootstrap.com/docs/4.5/examples/ *@
